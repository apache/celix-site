
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Building and Developing Apache Celix with CLion / Apache Celix</title>

    
    <link rel="icon" href="/assets/img/favicon.ico">

    
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="/assets/css/style.css" rel="stylesheet">

    <style>
         
         
        .card-body img {
            max-width: 100%;
            width: 100%;
            height: auto;
        }

         
        .card-body img + em {
            text-decoration: underline;
        }
    </style>

    
<script>
  var _paq = window._paq = window._paq || [];
   
  _paq.push(['disableCookies']);
   
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://analytics.apache.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '9']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>


</head>
<body class="light-grey">

<a href="https://github.com/apache/celix" class="github-ribbon">
    <img src="/assets/img/forkme_right_red_aa0000.png" alt="Fork me on GitHub">
</a>


<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="/assets/img/celix-white.svg" height="40" class="d-inline-block align-top" alt="Celix Logo">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/download.cgi">Download</a>
                </li>
                <li class="nav-item dropdown active">
                    <a class="nav-link dropdown-toggle" href="#" id="ddDocs" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Docs
                    </a>
                    <div class="dropdown-menu" aria-labelledby="ddDocs">
                        <a class="dropdown-item" href="/docs/2.4.0/docs.html">2.4.0 (latest)</a>
                        <a class="dropdown-item" href="/docs/2.2.1/docs.html">2.2.1</a>
                        <a class="dropdown-item" href="/docs/2.1.0/docs.html">2.1.0</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="ddContributing" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Contributing
                    </a>
                    <div class="dropdown-menu" aria-labelledby="ddContributing">
                        <a class="dropdown-item" href="/contributing/youatcelix.html">You at Celix</a>
                        <a class="dropdown-item" href="/contributing/submitting-patches.html">Submitting patches</a>
                        <a class="dropdown-item" href="/contributing/source-and-builds.html">Source code and builds</a>
                        <hr>
                        <a class="dropdown-item" href="/contributing/releasing.html">Releasing</a>
                        <a class="dropdown-item" href="/contributing/volunteers.html">Volunteers</a>
                        <a class="dropdown-item" href="https://whimsy.apache.org/board/minutes/Celix.html">Board Reports</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="ddSupport" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Support
                    </a>
                    <div class="dropdown-menu" aria-labelledby="ddSupport">
                        <a class="dropdown-item" href="/support/mailing-list.html">Mailing Lists</a>
                        <a class="dropdown-item" href="/support/issue-tracking.html">Issue Tracking</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="ddFoundation" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        ASF
                    </a>
                    <div class="dropdown-menu" aria-labelledby="ddFoundation">
                        <a class="dropdown-item" href="https://www.apache.org/">ASF Home</a>
                        <a class="dropdown-item" href="https://www.apache.org/foundation/how-it-works.html">How it works</a>
                        <a class="dropdown-item" href="https://www.apache.org/licenses/">License</a>
                        <a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
                        <a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
                        <a class="dropdown-item" href="https://www.apache.org/security/">Security</a>
                        <a class="dropdown-item" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div class="section">
    <div class="container">
        <div class="row py-4">
            <div class="col-sm-12 card">
                <div class="card-body pt-5">
                    
                    
                        
                        
                            <a class="edit-on-gh" href="https://github.com/apache/celix/edit/master/documents/building/dev_celix_with_clion.md" title="Edit this page on GitHub">Edit on GitHub</a>
                        
                    

                    
                        
                        <a href="/docs/2.4.0/docs.html" title="back to documentation">&lt;&lt; back to documentation</a>
                    

                    
	<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at
   
    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<h1 id="building-and-developing-apache-celix-with-clion">Building and Developing Apache Celix with CLion</h1>
<p>Apache Celix can be build for development in CLion with use of the Conan package manager.
Conan will arrange the building of the Apache Celix dependencies and generate Find<package> files for these dependencies.</p>
<p>Conan will also generate a <code>conanrun.sh</code> and <code>deactivate_conanrun.sh</code> script that does the environment (de)setup for the
binary locations of the build dependencies (i.e. configures <code>PATH</code> and <code>LD_LIBRARY_PATH</code>/<code>DYLD_LIBRARY_PATH</code>).</p>
<h2 id="configuring-clion-for-c17">Configuring CLion for C++17</h2>
<p>C++ code in Celix is default configured for C++14. This is manually changed for C++17 libraries, bundles and test code
by updating the CMAKE_CXX_STANDARD var (<code>set(CMAKE_CXX_STANDARD 17</code>) in their respective CMakelists.txt files.</p>
<p>The downside is that CLion seems to only take into account the top level CMAKE_CXX_STANDARD value.
To ensure that CLion provides the right syntax support for C++17, add <code>-DCMAKE_CXX_STANDARD=17</code> to the <code>CMake Options</code>
in <code>File</code> -&gt; <code>Settings</code> -&gt; <code>Build, Execution, Deployment</code> -&gt; <code>CMake</code>.</p>
<h2 id="setting-up-the-build-directory">Setting up the build directory</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#080;font-style:italic">#clone git repo</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/apache/celix.git
</span></span><span style="display:flex;"><span><span style="color:#a2f">cd</span> celix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">#if needed setup conan default and debug profile</span>
</span></span><span style="display:flex;"><span>conan profile new default --detect
</span></span><span style="display:flex;"><span>conan profile new debug --detect
</span></span><span style="display:flex;"><span>conan profile update settings.build_type<span style="color:#666">=</span>Debug debug
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Generate and configure cmake-build-debug directory</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># If CLion&#39;s CMake Preset Integration has been enabled, then CLion will load available CMake profiles </span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># from the CMakeUserPresets.json file at the project root, which is generated by `conan install`.</span>
</span></span><span style="display:flex;"><span>conan install . celix/2.3.0 -pr:b default -pr:h debug -if cmake-build-debug/ -o celix:enable_testing<span style="color:#666">=</span>True -o celix:enable_address_sanitizer<span style="color:#666">=</span>True -o celix:build_all<span style="color:#666">=</span>True -b missing
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">#optional build</span>
</span></span><span style="display:flex;"><span>conan build . -bf cmake-build-debug/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">#optional setup run env and run tests</span>
</span></span><span style="display:flex;"><span><span style="color:#a2f">cd</span> cmake-build-debug
</span></span><span style="display:flex;"><span><span style="color:#a2f">source</span> conanrun.sh 
</span></span><span style="display:flex;"><span>ctest --verbose
</span></span><span style="display:flex;"><span><span style="color:#a2f">source</span> deactivate_conanrun.sh 
</span></span></code></pre></div><h3 id="work-with-conan-2">Work with Conan 2</h3>
<p>The above is for Conan 1.x.
Conan 2 has greatly simplified its integration with CLion.
Issuing the following command will produce a CMakeUserPresets.json at the project root, which CLion will load automatically to set up CMake profiles.
Then Celix can be built within the IDE.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>conan install . -pr:b default -pr:h default -s:h <span style="color:#b8860b">build_type</span><span style="color:#666">=</span>Debug -o celix/*:build_all<span style="color:#666">=</span>True -o celix/*:celix_cxx17<span style="color:#666">=</span>True -o celix/*:enable_testing<span style="color:#666">=</span>True -b missing  -o celix/*:enable_address_sanitizer<span style="color:#666">=</span>True -of cmake-build-debug
</span></span></code></pre></div><h2 id="configuring-clion">Configuring CLion</h2>
<p>To ensure that all Conan build dependencies can be found the Run/Debug configurations of CLion needs te be updated.</p>
<p>This can be done under the menu &ldquo;Run-&gt;Edit Configurations&hellip;&rdquo;, then select &ldquo;Edit configuration templates&hellip;&rdquo; and
then update the &ldquo;Google Test&rdquo; template so that the <code>conanrun.sh</code> Conan generated script is sourced in the
&ldquo;Environment variables&rdquo; entry.</p>
<p>If the Apache Celix CMake build directory is <code>home/joe/workspace/celix/cmake-build-debug</code> then the value for
&ldquo;Environment variables&rdquo; should be: <code>source /home/joe/workspace/celix/cmake-build-debug/conanrun.sh</code></p>
<p><img src="media/clion_run_configuration_template.png" alt="Configure CLion"></p>


                </div>
            </div>
        </div>
    </div>
</div>


<footer class="py-3 bg-secondary">
    <div class="container">
        <div class="row">
            <div class="col-md-8 text-center">
                <p class="m-0 text-white">
                    Copyright &copy; 2023 The Apache Software Foundation, Licensed under
                    the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
                    <br>
                    Apache Celix, Celix, Apache, the Apache feather logo and the Apache Celix logo are trademarks of The Apache Software Foundation.
                </p>
            </div>
            <div class="col-md-4 text-center">
                <a href="https://www.apache.org/events/current-event.html" target="_blank">
                    <img src="https://www.apache.org/events/current-event-234x60.png" title="Apache Event" width="234" height="60" border="0">
                </a>
            </div>
        </div>
    </div>
</footer>


<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/bootstrap.bundle.min.js"></script>


</body>
</html>
